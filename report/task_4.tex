\begin{Figure}
    \centering
    \begin{tikzpicture}
        \begin{groupplot}[
            group style={
                group name = task_4,
                group size = 2 by 2,
                vertical sep=10pt,
                horizontal sep=10pt,
                xlabels at=edge bottom,
                ylabels at=edge left,
            },
            width=0.6\linewidth,
            height=0.6\linewidth,
            separate axis lines,
            xtick distance=0.5,
            ytick distance=0.5,
            xmin=0,
            xmax=1,
            ymin=0,
            ymax=1.05,
            xlabel={x},
            ylabel={y},
        ]

            \nextgroupplot[
                xticklabels=\empty,
            ]
                \addplot+[
                    scatter,
                    only marks,
                    scatter src=explicit,
                    scatter/use mapped color={
                        draw=black,
                        fill=blue,
                    },
                    visualization depends on=\thisrow{radius}\as\radius,
                    scatter/@pre marker code/.append style={
                        /tikz/mark size=\radius*50
                    }
                ]
                    table[
                        meta=count,
                    ]{../data/task_4_final_-1_particles.csv};

            \nextgroupplot
                \addplot+[
                    scatter,
                    only marks,
                    scatter src=explicit,
                    scatter/use mapped color={
                        draw=black,
                        fill=blue,
                    },
                    visualization depends on=\thisrow{radius}\as\radius,
                    scatter/@pre marker code/.append style={
                        /tikz/mark size=\radius*50
                    }
                ]
                    table[
                        meta=count,
                    ]{../data/task_4_final_-0.5_particles.csv};

            \nextgroupplot
                \addplot+[
                    scatter,
                    only marks,
                    scatter src=explicit,
                    scatter/use mapped color={
                        draw=black,
                        fill=blue,
                    },
                    visualization depends on=\thisrow{radius}\as\radius,
                    scatter/@pre marker code/.append style={
                        /tikz/mark size=\radius*50
                    }
                ]
                    table[
                        meta=count,
                    ]{../data/task_4_final_0.5_particles.csv};

            \nextgroupplot
                \addplot+[
                    scatter,
                    only marks,
                    scatter src=explicit,
                    scatter/use mapped color={
                        draw=black,
                        fill=blue,
                    },
                    visualization depends on=\thisrow{radius}\as\radius,
                    scatter/@pre marker code/.append style={
                        /tikz/mark size=\radius*50
                    }
                ]
                    table[
                        meta=count,
                    ]{../data/task_4_final_1_particles.csv};
            \end{groupplot}

            \begin{axis}[
                xlabel={x},
                grid=minor,
                anchor = north west,
                hide y axis,
                hide x axis,
            ]
            \end{axis}
    \end{tikzpicture}
    \captionof{figure}{The crater formed by a particle colliding with a "wall" of smaller particles.}
    \label{fig:task_4:before_and_after}
\end{Figure}

\begin{Figure}
    \centering
    \begin{tikzpicture}
        \begin{axis}[
            xlabel={x},
            ylabel={y},
            xtick=,
            xmin=0,
            xmax=1,
            ymin=0,
            ymax=1,
            grid=minor,
            colorbar,
        ]
        \addplot+[
            scatter,
            only marks,
            scatter src=explicit,
            scatter/use mapped color={
                draw=black,
                fill=mapped color,
            },
            visualization depends on=\thisrow{radius}\as\radius,
            scatter/@pre marker code/.append style={
                /tikz/mark size=\radius*170
            }
        ]
            table[
                meta=count,
            ]{../data/task_4_final_10_particles.csv};
        \end{axis}
    \end{tikzpicture}
\end{Figure}

\begin{Figure}
    \centering
    \begin{tikzpicture}
        \begin{axis}[
            xlabel={$\xi$},
            ylabel={Number of moved particles},
            ymin=0,
        ]
        \addplot+[
            scatter,
            only marks,
            scatter/use mapped color={
                draw=black,
                fill=mapped color,
            },
            ]table{../data/task_4_crater_size.csv};
        \end{axis}
    \end{tikzpicture}
    \captionof{figure}{Number of particles moved from their initial position as a function of the restitution coefficient $\xi$.}
    \label{fig:task_4:crater_size}
\end{Figure}
