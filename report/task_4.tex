\begin{frame}
\begin{figure}
    \centering
    \begin{tikzpicture}
        \pgfplotsset{every axis title/.append style={at={(0.5,0.7)}}}
        \begin{groupplot}[
            group style={
                group name = task_4,
                group size = 2 by 2,
                vertical sep=20pt,
                horizontal sep=30pt,
                xlabels at=edge bottom,
                ylabels at=edge left,
            },
            title={Parameter sweep},
            width=0.55\linewidth,
            height=0.45\linewidth,
            separate axis lines,
            xtick distance=0.5,
            ytick distance=0.5,
            xmin=0,
            xmax=1,
            ymin=0,
            ymax=1.05,
            xlabel={x},
            ylabel={y},
        ]

            \nextgroupplot[
                xticklabels=\empty,
                title={$\xi = 0.00$},
            ]
                \addplot+[
                    scatter,
                    only marks,
                    scatter src=explicit,
                    scatter/use mapped color={
                        draw=black,
                        fill=blue,
                    },
                    visualization depends on=\thisrow{radius}\as\radius,
                    scatter/@pre marker code/.append style={
                        /tikz/mark size=\radius*90
                    }
                ]
                    table[
                        meta=count,
                    ]{../data/task_4_final_0.00_particles.csv};

            \nextgroupplot[
                title={$\xi = 0.25$},
            ]
                \addplot+[
                    scatter,
                    only marks,
                    scatter src=explicit,
                    scatter/use mapped color={
                        draw=black,
                        fill=blue,
                    },
                    visualization depends on=\thisrow{radius}\as\radius,
                    scatter/@pre marker code/.append style={
                        /tikz/mark size=\radius*90
                    }
                ]
                    table[
                        meta=count,
                    ]{../data/task_4_final_0.25_particles.csv};

            \nextgroupplot[
                title={$\xi = 0.50$},
            ]
                \addplot+[
                    scatter,
                    only marks,
                    scatter src=explicit,
                    scatter/use mapped color={
                        draw=black,
                        fill=blue,
                    },
                    visualization depends on=\thisrow{radius}\as\radius,
                    scatter/@pre marker code/.append style={
                        /tikz/mark size=\radius*90
                    }
                ]
                    table[
                        meta=count,
                    ]{../data/task_4_final_0.50_particles.csv};

            \nextgroupplot[
                title={$\xi = 0.75$},
            ]
                \addplot+[
                    scatter,
                    only marks,
                    scatter src=explicit,
                    scatter/use mapped color={
                        draw=black,
                        fill=blue,
                    },
                    visualization depends on=\thisrow{radius}\as\radius,
                    scatter/@pre marker code/.append style={
                        /tikz/mark size=\radius*90
                    }
                ]
                    table[
                        meta=count,
                    ]{../data/task_4_final_0.75_particles.csv};
            \end{groupplot}

            \begin{axis}[
                xlabel={x},
                grid=minor,
                anchor = north west,
                hide y axis,
                hide x axis,
            ]
            \end{axis}
    \end{tikzpicture}
    %\captionof{figure}{The crater formed by a particle colliding with a "wall" of smaller particles.}
    %\label{fig:task_4:before_and_after}
\end{figure}
\end{frame}

\begin{frame}
\begin{figure}
    \centering
    \begin{tikzpicture}
        \begin{axis}[
            title={$\xi = 1.00$},
            xlabel={x},
            ylabel={y},
            xtick=,
            xmin=0,
            xmax=1,
            ymin=0,
            ymax=1,
            grid=minor,
            %colorbar,
        ]
        \addplot+[
            scatter,
            only marks,
            scatter src=explicit,
            scatter/use mapped color={
                draw=black,
                fill=blue,
            },
            visualization depends on=\thisrow{radius}\as\radius,
            scatter/@pre marker code/.append style={
                /tikz/mark size=\radius*170
            }
        ]
            table[
                meta=count,
            ]{../data/task_4_final_1.00_particles.csv};
        \end{axis}
    \end{tikzpicture}
\end{figure}
\end{frame}

\begin{frame}
\begin{figure}
    \centering
    \begin{tikzpicture}
        \begin{axis}[
            xlabel={$\xi$},
            ylabel={Crater size},
            y unit ={\%},
            ymin=0,
        ]
        \addplot[
            color=black,
            mark=square*,
            ] table[
            y expr = {\thisrow{size} / 18},
            ]{../data/task_4_crater_size.csv};
        \end{axis}
    \end{tikzpicture}
    %\captionof{figure}{Number of particles moved from their initial position as a function of the restitution coefficient $\xi$.}
    %\label{fig:task_4:crater_size}
\end{figure}
\end{frame}
